{"ast":null,"code":"import { db } from '../../config/firebase';\nimport { setCartItems, setIsProductsLoaded } from '../reducers/cartReducer';\nimport { doc, getDoc, setDoc } from 'firebase/firestore';\nimport { toast } from 'react-toastify';\nexport const addProductsToCart = (product, userId) => async dispatch => {\n  try {\n    const userCartRef = doc(db, 'carts', userId);\n    const cartDoc = await getDoc(userCartRef);\n    let updatedCart = [];\n    if (cartDoc.exists()) {\n      const existingCart = cartDoc.data().items || [];\n      const existingProductIndex = existingCart.findIndex(item => item.id === product.id);\n      if (existingProductIndex !== -1) {\n        existingCart[existingProductIndex].quantity += 1;\n        updatedCart = existingCart;\n      } else {\n        updatedCart = [...existingCart, {\n          ...product,\n          quantity: 1\n        }];\n      }\n    } else {\n      updatedCart = [{\n        ...product,\n        quantity: 1\n      }];\n    }\n    await setDoc(userCartRef, {\n      items: updatedCart\n    });\n    dispatch(setCartItems(updatedCart));\n    toast.success(\"Product added to cart!\");\n  } catch (error) {\n    console.error(\"Error adding to cart: \", error);\n    toast.error(\"Failed to add product to cart\");\n  }\n};\nexport const removeProductFromCart = (productId, userId) => async dispatch => {\n  try {\n    const userCartRef = doc(db, 'carts', userId);\n    const cartDoc = await getDoc(userCartRef);\n    if (!cartDoc.exists()) {\n      toast.error(\"Cart not found\");\n      return;\n    }\n    const existingCart = cartDoc.data().items || [];\n    const updatedCart = existingCart.filter(item => item.id !== productId);\n    await setDoc(userCartRef, {\n      items: updatedCart\n    });\n    dispatch(setCartItems(updatedCart));\n    toast.success(\"Product removed from cart!\");\n    return updatedCart;\n  } catch (error) {\n    console.error(\"Error removing from cart: \", error);\n    toast.error(\"Failed to remove product from cart\");\n  }\n};\nexport const fetchCartItems = uid => async dispatch => {\n  try {\n    if (!uid) throw new Error(\"User ID is required to fetch cart items\");\n    const cartRef = collection(db, \"users\", uid, \"cart\");\n    const snapshot = await getDocs(cartRef);\n    const cartItems = snapshot.docs.map(doc => ({\n      id: doc.id,\n      ...doc.data()\n    }));\n    dispatch({\n      type: \"SET_CART_ITEMS\",\n      payload: cartItems\n    });\n  } catch (error) {\n    console.error(\"Error fetching cart items: \", error);\n    toast.error(\"Failed to fetch product\");\n  }\n};","map":{"version":3,"names":["db","setCartItems","setIsProductsLoaded","doc","getDoc","setDoc","toast","addProductsToCart","product","userId","dispatch","userCartRef","cartDoc","updatedCart","exists","existingCart","data","items","existingProductIndex","findIndex","item","id","quantity","success","error","console","removeProductFromCart","productId","filter","fetchCartItems","uid","Error","cartRef","collection","snapshot","getDocs","cartItems","docs","map","type","payload"],"sources":["C:/Users/wadhe/OneDrive/Desktop/study/complete placment/Redux/project/scaffold/src/redux/actions/cartActions.js"],"sourcesContent":["import { db } from '../../config/firebase';\r\nimport { setCartItems, setIsProductsLoaded } from '../reducers/cartReducer';\r\nimport { doc, getDoc, setDoc } from 'firebase/firestore';\r\nimport { toast } from 'react-toastify';\r\n\r\n\r\nexport const addProductsToCart = (product, userId) => async (dispatch) => {\r\n  try {\r\n    const userCartRef = doc(db, 'carts', userId);\r\n    const cartDoc = await getDoc(userCartRef);\r\n    let updatedCart = [];\r\n\r\n    if (cartDoc.exists()) {\r\n      const existingCart = cartDoc.data().items || [];\r\n      const existingProductIndex = existingCart.findIndex(item => item.id === product.id);\r\n\r\n      if (existingProductIndex !== -1) {\r\n        existingCart[existingProductIndex].quantity += 1;\r\n        updatedCart = existingCart;\r\n      } else {\r\n        updatedCart = [...existingCart, { ...product, quantity: 1 }];\r\n      }\r\n    } else {\r\n      updatedCart = [{ ...product, quantity: 1 }];\r\n    }\r\n\r\n    await setDoc(userCartRef, { items: updatedCart });\r\n    dispatch(setCartItems(updatedCart));\r\n    toast.success(\"Product added to cart!\");\r\n  } catch (error) {\r\n    console.error(\"Error adding to cart: \", error);\r\n    toast.error(\"Failed to add product to cart\");\r\n  }\r\n};\r\n\r\n  \r\n\r\nexport const removeProductFromCart = (productId, userId) => async (dispatch) => {\r\n  try {\r\n    const userCartRef = doc(db, 'carts', userId);\r\n    const cartDoc = await getDoc(userCartRef);\r\n\r\n    if (!cartDoc.exists()) {\r\n      toast.error(\"Cart not found\");\r\n      return;\r\n    }\r\n\r\n    const existingCart = cartDoc.data().items || [];\r\n    const updatedCart = existingCart.filter(item => item.id !== productId);\r\n\r\n    await setDoc(userCartRef, { items: updatedCart });\r\n    dispatch(setCartItems(updatedCart));\r\n    toast.success(\"Product removed from cart!\");\r\n    \r\n    return updatedCart; \r\n  } catch (error) {\r\n    console.error(\"Error removing from cart: \", error);\r\n    toast.error(\"Failed to remove product from cart\");\r\n  }\r\n};\r\n\r\nexport const fetchCartItems = (uid) => async (dispatch) => {\r\n  try {\r\n    if (!uid) throw new Error(\"User ID is required to fetch cart items\");\r\n\r\n    const cartRef = collection(db, \"users\", uid, \"cart\");\r\n    const snapshot = await getDocs(cartRef);\r\n    const cartItems = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n\r\n    dispatch({ type: \"SET_CART_ITEMS\", payload: cartItems });\r\n  } catch (error) {\r\n    console.error(\"Error fetching cart items: \", error);\r\n    toast.error(\"Failed to fetch product\");\r\n\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}